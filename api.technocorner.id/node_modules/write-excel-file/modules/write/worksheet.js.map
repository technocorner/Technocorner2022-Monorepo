{"version":3,"sources":["../../source/write/worksheet.js"],"names":["generateRows","generateColumnsDescription","generateMergedCellsDescription","generateLayout","generateViews","WORKSHEET_TEMPLATE","generateWorksheet","data","schema","columns","headerStyle","getStyle","getSharedString","customFont","dateFormat","orientation","stickyRowsCount","stickyColumnsCount","sheetId","Array","isArray","TypeError","length","replace"],"mappings":"AAAA;AACA;AACA;AAEA,OAAOA,YAAP,MAAyB,QAAzB;AACA,OAAOC,0BAAP,MAAuC,WAAvC;AACA,OAAOC,8BAAP,MAA2C,kCAA3C;AACA,OAAOC,cAAP,MAA2B,UAA3B;AACA,OAAOC,aAAP,MAA0B,SAA1B,C,CAEA;AACA;;AAEA,IAAMC,kBAAkB,wrBAAxB;AAGA,eAAe,SAASC,iBAAT,CAA2BC,IAA3B,QAYZ;AAAA,MAXFC,MAWE,QAXFA,MAWE;AAAA,MAVFC,OAUE,QAVFA,OAUE;AAAA,MATFC,WASE,QATFA,WASE;AAAA,MARFC,QAQE,QARFA,QAQE;AAAA,MAPFC,eAOE,QAPFA,eAOE;AAAA,MANFC,UAME,QANFA,UAME;AAAA,MALFC,UAKE,QALFA,UAKE;AAAA,MAJFC,WAIE,QAJFA,WAIE;AAAA,MAHFC,eAGE,QAHFA,eAGE;AAAA,MAFFC,kBAEE,QAFFA,kBAEE;AAAA,MADFC,OACE,QADFA,OACE;;AACF,MAAIV,MAAJ,EAAY;AACX,QAAI,CAACW,KAAK,CAACC,OAAN,CAAcb,IAAd,CAAL,EAA0B;AACzB,YAAM,IAAIc,SAAJ,CAAc,8BAAd,CAAN;AACA;AACD,GAJD,MAIO;AACN,QAAI,CAACF,KAAK,CAACC,OAAN,CAAcb,IAAd,CAAL,EAA0B;AACzB,YAAM,IAAIc,SAAJ,CAAc,6BAAd,CAAN;AACA;;AACD,QAAId,IAAI,CAACe,MAAL,GAAc,CAAlB,EAAqB;AACpB,UAAI,CAACH,KAAK,CAACC,OAAN,CAAcb,IAAI,CAAC,CAAD,CAAlB,CAAL,EAA6B;AAC5B,cAAM,IAAIc,SAAJ,CAAc,6BAAd,CAAN;AACA;AACD;AACD;;AAEA,SAAOhB,kBAAkB,CACvBkB,OADK,CACG,QADH,EACavB,YAAY,CAACO,IAAD,EAAO;AACrCC,IAAAA,MAAM,EAANA,MADqC;AAErCE,IAAAA,WAAW,EAAXA,WAFqC;AAGrCC,IAAAA,QAAQ,EAARA,QAHqC;AAIrCC,IAAAA,eAAe,EAAfA,eAJqC;AAKrCC,IAAAA,UAAU,EAAVA,UALqC;AAMrCC,IAAAA,UAAU,EAAVA;AANqC,GAAP,CADzB,EASLS,OATK,CASG,SATH,EAScnB,aAAa,CAAC;AAAEY,IAAAA,eAAe,EAAfA,eAAF;AAAmBC,IAAAA,kBAAkB,EAAlBA;AAAnB,GAAD,CAT3B,EAULM,OAVK,CAUG,sBAVH,EAU2BtB,0BAA0B,CAAC;AAAEO,IAAAA,MAAM,EAANA,MAAF;AAAUC,IAAAA,OAAO,EAAPA;AAAV,GAAD,CAVrD,EAWLc,OAXK,CAWG,0BAXH,EAW+BrB,8BAA8B,CAACK,IAAD,EAAO;AAAEC,IAAAA,MAAM,EAANA;AAAF,GAAP,CAX7D,EAYLe,OAZK,CAYG,UAZH,EAYepB,cAAc,CAAC;AAAEe,IAAAA,OAAO,EAAPA,OAAF;AAAWH,IAAAA,WAAW,EAAXA;AAAX,GAAD,CAZ7B,CAAP;AAaD","sourcesContent":["// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/zipcelx.js\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/templates/worksheet.xml.js\r\n\r\nimport generateRows from './rows'\r\nimport generateColumnsDescription from './columns'\r\nimport generateMergedCellsDescription from './generateMergedCellsDescription'\r\nimport generateLayout from './layout'\r\nimport generateViews from './views'\r\n\r\n// const WORKSHEET_TEMPLATE = `<?xml version=\"1.0\" ?>\r\n// <worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:mv=\"urn:schemas-microsoft-com:mac:vml\" xmlns:mx=\"http://schemas.microsoft.com/office/mac/excel/2008/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\" xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\"><sheetData>{data}</sheetData></worksheet>`;\r\n\r\nconst WORKSHEET_TEMPLATE = `<?xml version=\"1.0\" ?>\r\n<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:mv=\"urn:schemas-microsoft-com:mac:vml\" xmlns:mx=\"http://schemas.microsoft.com/office/mac/excel/2008/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\" xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\">{views}{columnsDescription}<sheetData>{data}</sheetData>{mergedCellsDescription}{layout}</worksheet>`;\r\n\r\nexport default function generateWorksheet(data, {\r\n\tschema,\r\n\tcolumns,\r\n\theaderStyle,\r\n\tgetStyle,\r\n\tgetSharedString,\r\n\tcustomFont,\r\n\tdateFormat,\r\n\torientation,\r\n\tstickyRowsCount,\r\n\tstickyColumnsCount,\r\n\tsheetId\r\n}) {\r\n\tif (schema) {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError('Expected an array of objects')\r\n\t\t}\r\n\t} else {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError('Expected an array of arrays')\r\n\t\t}\r\n\t\tif (data.length > 0) {\r\n\t\t\tif (!Array.isArray(data[0])) {\r\n\t\t\t\tthrow new TypeError('Expected an array of arrays')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n  return WORKSHEET_TEMPLATE\r\n  \t.replace('{data}', generateRows(data, {\r\n  \t\tschema,\r\n  \t\theaderStyle,\r\n  \t\tgetStyle,\r\n  \t\tgetSharedString,\r\n  \t\tcustomFont,\r\n  \t\tdateFormat\r\n  \t}))\r\n  \t.replace('{views}', generateViews({ stickyRowsCount, stickyColumnsCount }))\r\n  \t.replace('{columnsDescription}', generateColumnsDescription({ schema, columns }))\r\n  \t.replace('{mergedCellsDescription}', generateMergedCellsDescription(data, { schema }))\r\n  \t.replace('{layout}', generateLayout({ sheetId, orientation }))\r\n}"],"file":"worksheet.js"}