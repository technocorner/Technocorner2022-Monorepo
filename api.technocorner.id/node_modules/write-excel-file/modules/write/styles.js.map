{"version":3,"sources":["../../source/write/styles.js"],"names":["FORMAT_ID_STARTS_FROM","initStyles","fontFamily","fontSize","customFont","Boolean","undefined","formats","formatsIndex","styles","stylesIndex","fonts","fontsIndex","fills","fillsIndex","borders","bordersIndex","push","size","family","custom","left","right","top","bottom","gray125","getStyle","fontWeight","fontStyle","align","alignVertical","format","wrap","color","backgroundColor","borderColor","borderStyle","leftBorderColor","leftBorderStyle","rightBorderColor","rightBorderStyle","topBorderColor","topBorderStyle","bottomBorderColor","bottomBorderStyle","border","fontKey","fillKey","borderKey","key","styleId","formatId","String","length","fontId","weight","style","fillId","borderId","getStylesXml","generateXml","xml","i","font","getColor","fill","getBorderXml","direction","hasChildren","cellStyle","filter","_","join","Error","slice","toUpperCase"],"mappings":"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","sourcesContent":["// There seem to be about 100 \"built-in\" formats in Excel.\r\n// https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2010/ee857658(v=office.14)?redirectedfrom=MSDN\r\nconst FORMAT_ID_STARTS_FROM = 100\r\n\r\nexport default function initStyles({\r\n  fontFamily,\r\n  fontSize\r\n}) {\r\n  const customFont = Boolean(fontFamily || fontSize)\r\n\r\n  if (fontFamily === undefined) {\r\n    fontFamily = 'Calibri'\r\n  }\r\n\r\n  if (fontSize === undefined) {\r\n    fontSize = 12\r\n  }\r\n\r\n  const formats = []\r\n  const formatsIndex = {}\r\n\r\n  const styles = []\r\n  const stylesIndex = {}\r\n\r\n  const fonts = []\r\n  const fontsIndex = {}\r\n\r\n  const fills = []\r\n  const fillsIndex = {}\r\n\r\n  const borders = []\r\n  const bordersIndex = {}\r\n\r\n  // Default font.\r\n  fonts.push({\r\n    size: fontSize,\r\n    family: fontFamily,\r\n    custom: customFont\r\n  })\r\n  fontsIndex['-:-'] = 0\r\n\r\n  // Default fill.\r\n  fills.push({})\r\n  fillsIndex['-'] = 0\r\n\r\n  // Default border.\r\n  borders.push({\r\n    left: {},\r\n    right: {},\r\n    top: {},\r\n    bottom: {}\r\n  })\r\n  bordersIndex['-:-/-:-/-:-/-:-'] = 0\r\n\r\n  // \"gray125\" fill.\r\n  // For some weird reason, MS Office 2007 Excel seems to require that to be present.\r\n  // Otherwise, if absent, it would replace the first `backgroundColor`.\r\n  fills.push({\r\n    gray125: true\r\n  })\r\n\r\n  function getStyle(\r\n    fontWeight,\r\n    fontStyle,\r\n    align,\r\n    alignVertical,\r\n    format,\r\n    wrap,\r\n    color,\r\n    backgroundColor,\r\n    borderColor,\r\n    borderStyle,\r\n    leftBorderColor,\r\n    leftBorderStyle,\r\n    rightBorderColor,\r\n    rightBorderStyle,\r\n    topBorderColor,\r\n    topBorderStyle,\r\n    bottomBorderColor,\r\n    bottomBorderStyle,\r\n  ) {\r\n    // Custom borders aren't supported.\r\n    const border = undefined\r\n    // Look for an existing style.\r\n    const fontKey = `${fontWeight || '-'}:${fontStyle || '-'}:${color || '-'}`\r\n    const fillKey = backgroundColor || '-'\r\n    const borderKey =\r\n      `${(topBorderColor || borderColor) || '-'}:${(topBorderStyle || borderStyle) || '-'}` +\r\n      '/' +\r\n      `${(rightBorderColor || borderColor) || '-'}:${(rightBorderStyle || borderStyle) || '-'}` +\r\n      '/' +\r\n      `${(bottomBorderColor || borderColor) || '-'}:${(bottomBorderStyle || borderStyle) || '-'}` +\r\n      '/' +\r\n      `${(leftBorderColor || borderColor) || '-'}:${(leftBorderStyle || borderStyle) || '-'}`\r\n    const key = `${align || '-'}/${alignVertical || '-'}/${format || '-'}/${wrap || '-'}/${fontKey}/${fillKey}/${borderKey}`\r\n    const styleId = stylesIndex[key]\r\n    if (styleId !== undefined) {\r\n      return styleId\r\n    }\r\n    // Create new style.\r\n    // Get format ID.\r\n    let formatId\r\n    if (format) {\r\n      formatId = formatsIndex[format]\r\n      if (formatId === undefined) {\r\n        formatId = formatsIndex[format] = String(FORMAT_ID_STARTS_FROM + formats.length)\r\n        formats.push(format)\r\n      }\r\n    }\r\n    // Get font ID.\r\n    let fontId = customFont ? 0 : undefined\r\n    if (fontWeight || fontStyle || color) {\r\n      fontId = fontsIndex[fontKey]\r\n      if (fontId === undefined) {\r\n        fontId = fontsIndex[fontKey] = String(fonts.length)\r\n        fonts.push({\r\n          custom: true,\r\n          size: fontSize,\r\n          family: fontFamily,\r\n          weight: fontWeight,\r\n          style: fontStyle,\r\n          color\r\n        })\r\n      }\r\n    }\r\n    // Get fill ID.\r\n    let fillId\r\n    if (backgroundColor) {\r\n      fillId = fillsIndex[fillKey]\r\n      if (fillId === undefined) {\r\n        fillId = fillsIndex[fillKey] = String(fills.length)\r\n        fills.push({\r\n          color: backgroundColor\r\n        })\r\n      }\r\n    }\r\n    // Get border ID.\r\n    let borderId\r\n    if (\r\n      borderColor ||\r\n      borderStyle ||\r\n      leftBorderColor ||\r\n      leftBorderStyle ||\r\n      rightBorderColor ||\r\n      rightBorderStyle ||\r\n      topBorderColor ||\r\n      topBorderStyle ||\r\n      bottomBorderColor ||\r\n      bottomBorderStyle\r\n    ) {\r\n      borderId = bordersIndex[borderKey]\r\n      if (borderId === undefined) {\r\n        borderId = bordersIndex[borderKey] = String(borders.length)\r\n        borders.push({\r\n          left: {\r\n            style: leftBorderStyle || borderStyle,\r\n            color: leftBorderColor || borderColor\r\n          },\r\n          right: {\r\n            style: rightBorderStyle || borderStyle,\r\n            color: rightBorderColor || borderColor\r\n          },\r\n          top: {\r\n            style: topBorderStyle || borderStyle,\r\n            color: topBorderColor || borderColor\r\n          },\r\n          bottom: {\r\n            style: bottomBorderStyle || borderStyle,\r\n            color: bottomBorderColor || borderColor\r\n          }\r\n        })\r\n      }\r\n    }\r\n    // Add a style.\r\n    styles.push({\r\n      fontId,\r\n      fillId,\r\n      borderId,\r\n      align,\r\n      alignVertical,\r\n      wrap,\r\n      formatId\r\n    })\r\n    return stylesIndex[key] = String(styles.length - 1)\r\n  }\r\n\r\n  // Add the default style.\r\n  getStyle()\r\n\r\n  return {\r\n    getStylesXml() {\r\n      return generateXml({ formats, styles, fonts, fills, borders })\r\n    },\r\n    getStyle\r\n  }\r\n}\r\n\r\nfunction generateXml({ formats, styles, fonts, fills, borders }) {\r\n  let xml = '<?xml version=\"1.0\" ?>'\r\n  xml += '<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">'\r\n\r\n  // Turns out, as weird as it sounds, the order of XML elements matters to MS Office Excel.\r\n  // https://social.msdn.microsoft.com/Forums/office/en-US/cc47ab65-dab7-4e32-b676-b641aa1e1411/how-to-validate-the-xlsx-that-i-generate?forum=oxmlsdk\r\n  // For example, previously this library was inserting `<cellXfs/>` before `<fonts/>`\r\n  // and that caused MS Office 2007 Excel to throw an error about the file being corrupt:\r\n  // \"Excel found unreadable content in '*.xlsx'. Do you want to recover the contents of this workbook?\"\r\n  // \"Excel was able to open the file by repairing or removing the unreadable content.\"\r\n  // \"Removed Part: /xl/styles.xml part with XML error.  (Styles) Load error. Line 1, column ...\"\r\n  // \"Repaired Records: Cell information from /xl/worksheets/sheet1.xml part\"\r\n\r\n  if (formats.length > 0) {\r\n    xml += `<numFmts count=\"${formats.length}\">`\r\n    for (let i = 0; i < formats.length; i++) {\r\n      xml += `<numFmt numFmtId=\"${FORMAT_ID_STARTS_FROM + i}\" formatCode=\"${formats[i]}\"/>`\r\n    }\r\n    xml += `</numFmts>`\r\n  }\r\n\r\n  xml += `<fonts count=\"${fonts.length}\">`\r\n  for (const font of fonts) {\r\n    const {\r\n      size,\r\n      family,\r\n      color,\r\n      weight,\r\n      style,\r\n      custom\r\n    } = font\r\n    xml += '<font>'\r\n    xml += `<sz val=\"${size}\"/>`\r\n    xml += `<color ${color ? 'rgb=\"' + getColor(color) + '\"' : 'theme=\"1\"'}/>`\r\n    xml += `<name val=\"${family}\"/>`\r\n    // It's not clear what the `<family/>` tag means or does.\r\n    // It seems to always be `<family val=\"2\"/>` even for different\r\n    // font families (Calibri, Arial, etc).\r\n    xml += '<family val=\"2\"/>'\r\n    //\r\n    // It's not clear what the `<scheme/>` tag means or does.\r\n    // Seems like it's only preset for the default \"Calibri\" font.\r\n    // Adding it to any other font resets the font family in Microsoft Excel 2007.\r\n    //\r\n    // \"Defines the font scheme, if any, to which this font belongs.\r\n    //  When a font definition is part of a theme definition, then the font\r\n    //  is categorized as either a \"major\" or \"minor\" font scheme component.\r\n    //  When a new theme is chosen, every font that is part of a theme definition\r\n    //  is updated to use the new \"major\" or \"minor\" font definition for that theme.\r\n    //  Usually \"major\" fonts are used for styles like headings,\r\n    //  and \"minor\" fonts are used for body and paragraph text.\"\r\n    //\r\n    // https://hackage.haskell.org/package/xlsx-0.8.4/docs/Codec-Xlsx-Types-StyleSheet.html\r\n    //\r\n    if (!custom) {\r\n      xml += '<scheme val=\"minor\"/>'\r\n    }\r\n    if (weight === 'bold') {\r\n      xml += '<b/>'\r\n    }\r\n    if (style === 'italic') {\r\n      xml += '<i/>'\r\n    }\r\n    xml += '</font>'\r\n  }\r\n  xml += '</fonts>'\r\n\r\n  // MS Office 2007 Excel seems to require a `<fills/>` element to exist.\r\n  // without it, MS Office 2007 Excel thinks that the file is broken.\r\n  xml += `<fills count=\"${fills.length}\">`\r\n  for (const fill of fills) {\r\n    const { color, gray125 } = fill\r\n    xml += '<fill>'\r\n    if (color) {\r\n      xml += '<patternFill patternType=\"solid\">'\r\n      xml += `<fgColor rgb=\"${getColor(color)}\"/>`\r\n      // Whatever that could mean.\r\n      xml += '<bgColor indexed=\"64\"/>'\r\n      xml += '</patternFill>'\r\n    } else if (gray125) {\r\n      // \"gray125\" fill.\r\n      // For some weird reason, MS Office 2007 Excel seems to require that to be present.\r\n      // Otherwise, if absent, it would replace the first `backgroundColor`.\r\n      xml += '<patternFill patternType=\"gray125\"/>'\r\n    } else {\r\n      xml += '<patternFill patternType=\"none\"/>'\r\n    }\r\n    xml += '</fill>'\r\n  }\r\n  xml += '</fills>'\r\n\r\n  // MS Office 2007 Excel seems to require a `<borders/>` element to exist:\r\n  // without it, MS Office 2007 Excel thinks that the file is broken.\r\n  xml += `<borders count=\"${borders.length}\">`\r\n  for (const border of borders) {\r\n    const {\r\n      left,\r\n      right,\r\n      top,\r\n      bottom\r\n    } = border\r\n    const getBorderXml = (direction, { style, color }) => {\r\n      if (color && !style) {\r\n        style = 'thin'\r\n      }\r\n      const hasChildren = color ? true : false\r\n      return `<${direction}` +\r\n        (style ? ` style=\"${style}\"` : '') +\r\n        (hasChildren ? '>' : '/>') +\r\n        (color ? `<color rgb=\"${getColor(color)}\"/>` : '') +\r\n        (hasChildren ? `</${direction}>` : '')\r\n    }\r\n    xml += '<border>'\r\n    xml += getBorderXml('left', left)\r\n    xml += getBorderXml('right', right)\r\n    xml += getBorderXml('top', top)\r\n    xml += getBorderXml('bottom', bottom)\r\n    xml += '<diagonal/>'\r\n    xml += '</border>'\r\n  }\r\n  xml += '</borders>'\r\n\r\n  // What are `<cellXfs/>` and `<cellStyleXfs/>`:\r\n  // http://officeopenxml.com/SSstyles.php\r\n  //\r\n  // `<cellStyleXfs/>` are referenced from `<cellXfs/>` as `<xf xfId=\"...\"/>`.\r\n  // `<cellStyleXfs/>` defines abstract \"cell styles\" that can be \"extended\"\r\n  // by \"cell styles\" defined by `<cellXfs/>` that can be applied to individual cells:\r\n  // 1. `<cellStyleXfs><xf .../></cellStyleXfs>`\r\n  // 2. `<cellXfs><xf xfId={cellStyleXfs.xf.index}/></cellXfs>`\r\n  // 3. `<c s={cellXfs.xf.index}/>`\r\n  // Seems like \"cell styles\" defined by `<cellXfs/>` have to reference\r\n  // some abstract \"cell styles\" defined by `<cellStyleXfs/>` by the spec.\r\n  // Otherwise, there would be no need to use `<cellStyleXfs/>` at all.\r\n  // The naming is ambiguous and weird. The whole scheme is needlessly redundant.\r\n\r\n  // xml += '<cellStyleXfs count=\"2\">'\r\n  // xml += '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/>'\r\n  // // `applyFont=\"1\"` means apply a custom font in this \"abstract\" \"cell style\"\r\n  // // rather than using a default font.\r\n  // // Seems like by default `applyFont` is `\"0\"` meaning that,\r\n  // // unless `\"1\"` is specified, it would ignore the `fontId` attribute.\r\n  // xml += '<xf numFmtId=\"0\" fontId=\"1\" applyFont=\"1\" fillId=\"0\" borderId=\"0\"/>'\r\n  // xml += '</cellStyleXfs>'\r\n\r\n  xml += `<cellXfs count=\"${styles.length}\">`\r\n  for (const cellStyle of styles) {\r\n    const {\r\n      fontId,\r\n      fillId,\r\n      borderId,\r\n      align,\r\n      alignVertical,\r\n      wrap,\r\n      formatId\r\n    } = cellStyle\r\n    // `applyNumberFormat=\"1\"` means \"apply the `numFmtId` attribute\".\r\n    // Seems like by default `applyNumberFormat` is `\"0\"` meaning that,\r\n    // unless `\"1\"` is specified, it would ignore the `numFmtId` attribute.\r\n    xml += '<xf ' +\r\n      [\r\n        formatId !== undefined ? `numFmtId=\"${formatId}\"` : undefined,\r\n        formatId !== undefined ? 'applyNumberFormat=\"1\"' : undefined,\r\n        fontId !== undefined ? `fontId=\"${fontId}\"` : undefined,\r\n        fontId !== undefined ? 'applyFont=\"1\"' : undefined,\r\n        fillId !== undefined ? `fillId=\"${fillId}\"` : undefined,\r\n        fillId !== undefined ? 'applyFill=\"1\"' : undefined,\r\n        borderId !== undefined ? `borderId=\"${borderId}\"` : undefined,\r\n        borderId !== undefined ? 'applyBorder=\"1\"' : undefined,\r\n        align || alignVertical || wrap ? 'applyAlignment=\"1\"' : undefined,\r\n        // 'xfId=\"0\"'\r\n      ].filter(_ => _).join(' ') +\r\n    '>' +\r\n      // Possible horizontal alignment values:\r\n      //  left, center, right, fill, justify, center_across, distributed.\r\n      // Possible vertical alignment values:\r\n      //  top, vcenter, bottom, vjustify, vdistributed.\r\n      // https://xlsxwriter.readthedocs.io/format.html#set_align\r\n      (align || alignVertical || wrap\r\n        ? '<alignment' +\r\n          (align ? ` horizontal=\"${align}\"` : '') +\r\n          (alignVertical ? ` vertical=\"${alignVertical}\"` : '') +\r\n          (wrap ? ` wrapText=\"1\"` : '') +\r\n          '/>'\r\n        : ''\r\n      ) +\r\n    '</xf>'\r\n  }\r\n  xml += `</cellXfs>`\r\n\r\n  xml += '</styleSheet>'\r\n\r\n  return xml\r\n}\r\n\r\nfunction getColor(color) {\r\n  if (color[0] !== '#') {\r\n    throw new Error(`Color \"${color}\" must start with a \"#\"`)\r\n  }\r\n  return `FF${color.slice('#'.length).toUpperCase()}`\r\n}"],"file":"styles.js"}